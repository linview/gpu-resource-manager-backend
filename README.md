# GPUèµ„æºç®¡ç†ç³»ç»Ÿ

åŸºäºäº‹ä»¶é©±åŠ¨æ¶æ„çš„GPUèµ„æºç®¡ç†åå°ç³»ç»Ÿï¼Œæ”¯æŒè£¸é‡‘å±GPUæœåŠ¡å™¨çš„è‡ªåŠ¨åŒ–éƒ¨ç½²å’Œç®¡ç†ã€‚

## é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ªä¼ä¸šçº§GPUåŸºç¡€è®¾æ–½ç®¡ç†å¹³å°ï¼Œé‡‡ç”¨**æ¨¡å¼A: IaaSä½œä¸ºèµ„æºç¼–æ’å±‚**çš„æ¶æ„è®¾è®¡ï¼Œå®ç°GPUèµ„æºçš„å…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€‚

### æ ¸å¿ƒç‰¹æ€§

- ğŸš€ **äº‹ä»¶é©±åŠ¨æ¶æ„**: åŸºäºNATS JetStreamçš„å®æ—¶äº‹ä»¶å¤„ç†
- ğŸ”§ **ç¡¬ä»¶è‡ªåŠ¨åŒ–**: é›†æˆTinkerbellå®ç°è£¸é‡‘å±æœåŠ¡å™¨è‡ªåŠ¨åŒ–éƒ¨ç½²
- ğŸ“Š **æ™ºèƒ½ç›‘æ§**: å®æ—¶GPUçŠ¶æ€ç›‘æ§å’Œå‘Šè­¦å…³è”åˆ†æ
- ğŸ”„ **äº‘åŸç”Ÿ**: åŸºäºKubernetesçš„å®¹å™¨åŒ–éƒ¨ç½²
- ğŸ›¡ï¸ **å®‰å…¨å¯é **: æ”¯æŒå¤šç§ç¡¬ä»¶ç®¡ç†åè®®(IPMI/Redfish/gNMI)
- âš¡ **é«˜æ€§èƒ½**: åŸºäºEcho v4.11.4çš„é«˜æ€§èƒ½Webæ¡†æ¶

### æŠ€æœ¯æ ˆ

- **ä¸»è¦è¯­è¨€**: Golang 1.21+ (æ ¸å¿ƒå¾®æœåŠ¡)
- **è¾…åŠ©è¯­è¨€**: Python (å·¥å…·å¼€å‘)
- **Webæ¡†æ¶**: Echo v4.11.4 (MVPé€‰å®š)
- **å®¹å™¨ç¼–æ’**: Kubernetes (k0s)
- **ç¡¬ä»¶ç®¡ç†**: Tinkerbell v0.12.2
- **æ“ä½œç³»ç»Ÿ**: Talos Linux
- **é…ç½®ç®¡ç†**: Cloud-init
- **æ•°æ®å­˜å‚¨**: PostgreSQL + Redis + InfluxDB
- **æ¶ˆæ¯é˜Ÿåˆ—**: NATS JetStream (MVP) / Kafka (ç”Ÿäº§ç¯å¢ƒ)
- **APIæ¥å£**: REST (MVP) + gRPC/GraphQL (P1)
- **æµ‹è¯•æ¡†æ¶**: Testcontainers-Go + k8s

## æ¶æ„è®¾è®¡

### æ¶æ„æ¨¡å¼

ç³»ç»Ÿé‡‡ç”¨**IaaSä½œä¸ºèµ„æºç¼–æ’å±‚**çš„æ¶æ„è®¾è®¡ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   åº”ç”¨å±‚ (Application Layer)                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚  ç”¨æˆ·ç•Œé¢   â”‚ â”‚  APIç½‘å…³    â”‚ â”‚  IaaSæœåŠ¡   â”‚           â”‚
â”‚  â”‚             â”‚ â”‚             â”‚ â”‚             â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  ç¼–æ’å±‚ (Orchestration Layer)               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ Kubernetes  â”‚ â”‚ Tinkerbell  â”‚ â”‚   CRDèµ„æº   â”‚           â”‚
â”‚  â”‚   (k0s)     â”‚ â”‚             â”‚ â”‚             â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  ç¡¬ä»¶å±‚ (Hardware Layer)                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚   IPMI      â”‚ â”‚  Redfish    â”‚ â”‚   gNMI      â”‚           â”‚
â”‚  â”‚   åè®®      â”‚ â”‚   åè®®      â”‚ â”‚   åè®®      â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               åŸºç¡€è®¾æ–½å±‚ (Infrastructure Layer)             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ Talos Linux â”‚ â”‚    k0s      â”‚ â”‚ Cloud-init  â”‚           â”‚
â”‚  â”‚             â”‚ â”‚   é›†ç¾¤      â”‚ â”‚             â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### äº‹ä»¶é©±åŠ¨æ¶æ„

ç³»ç»Ÿé‡‡ç”¨äº‹ä»¶é©±åŠ¨æ¶æ„ï¼Œé€šè¿‡NATS JetStreamå®ç°ç»„ä»¶é—´çš„æ¾è€¦åˆé€šä¿¡ï¼š

- **ç¡¬ä»¶å‘ç°äº‹ä»¶**: è‡ªåŠ¨å‘ç°å’Œæ³¨å†ŒGPUæœåŠ¡å™¨
- **çŠ¶æ€å˜åŒ–äº‹ä»¶**: å®æ—¶ç›‘æ§GPUçŠ¶æ€å˜åŒ–
- **å‘Šè­¦äº‹ä»¶**: æ™ºèƒ½å‘Šè­¦å…³è”åˆ†æ
- **é…ç½®å˜æ›´äº‹ä»¶**: è‡ªåŠ¨åŒ–é…ç½®ç®¡ç†

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Go 1.21+
- Docker & Docker Compose
- Kubernetesé›†ç¾¤ (å¯é€‰)
- ç¡¬ä»¶æœåŠ¡å™¨ (æ”¯æŒIPMI/Redfish)

### æœ¬åœ°å¼€å‘

1. **å…‹éš†é¡¹ç›®**
```bash
git clone https://github.com/linview/gpu-resource-manager-backend.git
cd gpu-resource-manager-backend
```

2. **å®‰è£…ä¾èµ–**
```bash
go mod download
```

3. **é…ç½®ç¯å¢ƒå˜é‡**
```bash
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶é…ç½®æ•°æ®åº“ç­‰è¿æ¥ä¿¡æ¯
```

4. **å¯åŠ¨ä¾èµ–æœåŠ¡**
```bash
cd deployments/docker
docker-compose up -d postgres redis nats
```

5. **è¿è¡Œåº”ç”¨**
```bash
go run cmd/server/main.go
```

### Dockeréƒ¨ç½²

1. **æ„å»ºé•œåƒ**
```bash
docker build -t palebluedot-backend:latest .
```

2. **å¯åŠ¨å®Œæ•´æœåŠ¡æ ˆ**
```bash
cd deployments/docker
docker-compose up -d
```

### Kuberneteséƒ¨ç½²

1. **éƒ¨ç½²Tinkerbell**
```bash
kubectl apply -f deployments/tinkerbell/tinkerbell-deployment.yaml
```

2. **éƒ¨ç½²GPUç®¡ç†ç³»ç»Ÿ**
```bash
kubectl apply -f deployments/kubernetes/k0s-cluster.yaml
```

## APIæ–‡æ¡£

### æ ¸å¿ƒAPIæ¥å£

#### GPUç®¡ç†
- `GET /api/v1/gpus` - è·å–GPUåˆ—è¡¨
- `GET /api/v1/gpus/{id}` - è·å–GPUè¯¦æƒ…
- `PUT /api/v1/gpus/{id}` - æ›´æ–°GPUä¿¡æ¯
- `GET /api/v1/gpus/{id}/status` - è·å–GPUçŠ¶æ€
- `GET /api/v1/gpus/{id}/metrics` - è·å–GPUæŒ‡æ ‡
- `POST /api/v1/gpus/{id}/config` - æ›´æ–°GPUé…ç½®
- `GET /api/v1/gpus/{id}/config` - è·å–GPUé…ç½®
- `GET /api/v1/gpus/{id}/config/versions` - è·å–é…ç½®ç‰ˆæœ¬

#### æœåŠ¡å™¨ç®¡ç†
- `GET /api/v1/servers` - è·å–æœåŠ¡å™¨åˆ—è¡¨
- `POST /api/v1/servers` - åˆ›å»ºæœåŠ¡å™¨
- `GET /api/v1/servers/{id}` - è·å–æœåŠ¡å™¨è¯¦æƒ…
- `PUT /api/v1/servers/{id}` - æ›´æ–°æœåŠ¡å™¨ä¿¡æ¯
- `DELETE /api/v1/servers/{id}` - åˆ é™¤æœåŠ¡å™¨
- `POST /api/v1/servers/{id}/power` - ç”µæºæ§åˆ¶
- `GET /api/v1/servers/{id}/status` - è·å–æœåŠ¡å™¨çŠ¶æ€
- `PUT /api/v1/servers/{id}/bios` - é…ç½®BIOS
- `POST /api/v1/servers/{id}/firmware` - å‡çº§å›ºä»¶
- `GET /api/v1/servers/{id}/gpus` - è·å–æœåŠ¡å™¨GPU
- `POST /api/v1/servers/{id}/gpus` - æ·»åŠ GPUåˆ°æœåŠ¡å™¨
- `GET /api/v1/servers/{id}/config` - è·å–æœåŠ¡å™¨é…ç½®
- `PUT /api/v1/servers/{id}/config` - æ›´æ–°æœåŠ¡å™¨é…ç½®
- `GET /api/v1/servers/{id}/config/versions` - è·å–é…ç½®ç‰ˆæœ¬

#### èµ„æºåˆ†é…
- `GET /api/v1/allocations` - è·å–åˆ†é…åˆ—è¡¨
- `POST /api/v1/allocations` - åˆ›å»ºèµ„æºåˆ†é…
- `GET /api/v1/allocations/{id}` - è·å–åˆ†é…è¯¦æƒ…
- `PUT /api/v1/allocations/{id}` - æ›´æ–°åˆ†é…
- `DELETE /api/v1/allocations/{id}` - é‡Šæ”¾èµ„æºåˆ†é…
- `POST /api/v1/allocations/{id}/start` - å¯åŠ¨åˆ†é…
- `POST /api/v1/allocations/{id}/stop` - åœæ­¢åˆ†é…
- `GET /api/v1/allocations/{id}/status` - è·å–åˆ†é…çŠ¶æ€

#### å·¥ä½œæµç®¡ç†
- `GET /api/v1/workflows` - è·å–å·¥ä½œæµåˆ—è¡¨
- `POST /api/v1/workflows` - åˆ›å»ºå·¥ä½œæµ
- `GET /api/v1/workflows/{id}` - è·å–å·¥ä½œæµè¯¦æƒ…
- `DELETE /api/v1/workflows/{id}` - åˆ é™¤å·¥ä½œæµ
- `POST /api/v1/workflows/deploy` - åˆ›å»ºéƒ¨ç½²å·¥ä½œæµ
- `POST /api/v1/workflows/cleanup` - åˆ›å»ºæ¸…ç†å·¥ä½œæµ

#### äº‹ä»¶ç®¡ç†
- `GET /api/v1/events` - è·å–äº‹ä»¶åˆ—è¡¨
- `POST /api/v1/events` - åˆ›å»ºäº‹ä»¶
- `GET /api/v1/events/{id}` - è·å–äº‹ä»¶è¯¦æƒ…

#### å‘Šè­¦ç®¡ç†
- `GET /api/v1/alerts` - è·å–å‘Šè­¦åˆ—è¡¨
- `POST /api/v1/alerts` - åˆ›å»ºå‘Šè­¦
- `PUT /api/v1/alerts/{id}` - æ›´æ–°å‘Šè­¦
- `GET /api/v1/alerts/correlation` - è·å–å‘Šè­¦å…³è”åˆ†æ

### ç¤ºä¾‹è¯·æ±‚

#### åˆ›å»ºGPUåˆ†é…
```bash
curl -X POST http://localhost:8080/api/v1/allocations \
  -H "Content-Type: application/json" \
  -d '{
    "user_id": "user123",
    "server_id": "server456",
    "purpose": "AIè®­ç»ƒ"
  }'
```

#### è·å–GPUçŠ¶æ€
```bash
curl http://localhost:8080/api/v1/gpus/gpu-001/status
```

#### æ›´æ–°GPUé…ç½®
```bash
curl -X POST http://localhost:8080/api/v1/gpus/gpu-001/config \
  -H "Content-Type: application/json" \
  -d '{
    "power_limit": 200,
    "memory_clock": 8000
  }'
```

### APIå“åº”æ ¼å¼

æ‰€æœ‰APIå“åº”éƒ½åŒ…å«è¯·æ±‚è¿½è¸ªä¿¡æ¯ï¼š

```json
{
  "data": [...],
  "total": 1,
  "request_id": "38c23617-7afc-2547-8aaf-be8b6e6c1e67",
  "operation": "gpu_list"
}
```

## é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡

| å˜é‡å | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|--------|------|
| `SERVER_PORT` | 8080 | æœåŠ¡ç«¯å£ |
| `DB_HOST` | localhost | æ•°æ®åº“ä¸»æœº |
| `DB_PORT` | 5432 | æ•°æ®åº“ç«¯å£ |
| `DB_USER` | postgres | æ•°æ®åº“ç”¨æˆ· |
| `DB_PASSWORD` | password | æ•°æ®åº“å¯†ç  |
| `REDIS_HOST` | localhost | Redisä¸»æœº |
| `NATS_URL` | nats://localhost:4222 | NATSè¿æ¥åœ°å€ |
| `TINKERBELL_URL` | http://localhost:50061 | Tinkerbell APIåœ°å€ |

### Tinkerbellé…ç½®

Tinkerbellé…ç½®æ–‡ä»¶ä½äº `deployments/tinkerbell/tinkerbell-config.yaml`ï¼ŒåŒ…å«ï¼š

- ç¡¬ä»¶ç®¡ç†åè®®é…ç½® (IPMI/Redfish/gNMI)
- æ“ä½œç³»ç»Ÿæ¨¡æ¿ (Talos Linux/Ubuntu)
- GPUé©±åŠ¨å®‰è£…è„šæœ¬
- ç½‘ç»œå’Œå­˜å‚¨é…ç½®

## ç›‘æ§å’Œå‘Šè­¦

### ç›‘æ§æŒ‡æ ‡

- **GPUæŒ‡æ ‡**: åˆ©ç”¨ç‡ã€æ¸©åº¦ã€åŠŸè€—ã€å†…å­˜ä½¿ç”¨
- **ç³»ç»ŸæŒ‡æ ‡**: CPUã€å†…å­˜ã€ç½‘ç»œã€ç£ç›˜
- **ä¸šåŠ¡æŒ‡æ ‡**: åˆ†é…æˆåŠŸç‡ã€å“åº”æ—¶é—´ã€é”™è¯¯ç‡

### å‘Šè­¦è§„åˆ™

- GPUæ¸©åº¦è¶…è¿‡85Â°C
- GPUåˆ©ç”¨ç‡è¶…è¿‡95%
- å†…å­˜ä½¿ç”¨ç‡è¶…è¿‡90%
- ç³»ç»Ÿé”™è¯¯ç‡è¶…è¿‡5%

### è®¿é—®ç›‘æ§ç•Œé¢

- **Grafana**: http://localhost:3000 (admin/admin)
- **Prometheus**: http://localhost:9090
- **Alertmanager**: http://localhost:9093

## å¼€å‘æŒ‡å—

### é¡¹ç›®ç»“æ„

```
palebluedot-backend/
â”œâ”€â”€ cmd/server/           # åº”ç”¨å…¥å£
â”œâ”€â”€ internal/             # å†…éƒ¨åŒ…
â”‚   â”œâ”€â”€ api/             # APIå±‚
â”‚   â”‚   â”œâ”€â”€ handlers/    # å¤„ç†å™¨
â”‚   â”‚   â”œâ”€â”€ middleware/  # ä¸­é—´ä»¶
â”‚   â”‚   â””â”€â”€ routes/      # è·¯ç”±é…ç½®
â”‚   â”œâ”€â”€ config/          # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ models/          # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ services/        # ä¸šåŠ¡æœåŠ¡
â”‚   â”‚   â””â”€â”€ event/       # äº‹ä»¶æœåŠ¡
â”‚   â””â”€â”€ repository/      # æ•°æ®è®¿é—®å±‚
â”œâ”€â”€ pkg/                 # å…¬å…±åŒ…
â”‚   â””â”€â”€ logger/          # æ—¥å¿—ç»„ä»¶
â”œâ”€â”€ deployments/         # éƒ¨ç½²é…ç½®
â”œâ”€â”€ docs/               # æ–‡æ¡£
â”‚   â”œâ”€â”€ analysis/       # æŠ€æœ¯åˆ†æ
â”‚   â”œâ”€â”€ design/         # æ¶æ„è®¾è®¡
â”‚   â””â”€â”€ review/         # ä»£ç è¯„å®¡
â””â”€â”€ tests/              # æµ‹è¯•
```

### å¼€å‘è§„èŒƒ

- éµå¾ªGoå®˜æ–¹ä»£ç è§„èŒƒ
- ä½¿ç”¨ç»“æ„åŒ–æ—¥å¿—è®°å½•
- ç¼–å†™å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
- ä½¿ç”¨è¯­ä¹‰åŒ–ç‰ˆæœ¬æ§åˆ¶
- éµå¾ªGoè¯­è¨€Contextæœ€ä½³å®è·µ

### æµ‹è¯•

```bash
# è¿è¡Œå•å…ƒæµ‹è¯•
go test ./...

# è¿è¡Œé›†æˆæµ‹è¯•
go test -tags=integration ./...

# è¿è¡Œæ€§èƒ½æµ‹è¯•
go test -bench=. ./...
```

## éƒ¨ç½²æ¶æ„

### Docker Composeéƒ¨ç½²æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   åå‘ä»£ç†å±‚ (Nginx)                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚   HTTP      â”‚ â”‚   HTTPS     â”‚ â”‚   è´Ÿè½½å‡è¡¡   â”‚           â”‚
â”‚  â”‚   (80)      â”‚ â”‚   (443)     â”‚ â”‚             â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  åº”ç”¨æœåŠ¡å±‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ GPUç®¡ç†API  â”‚ â”‚ Tinkerbell  â”‚ â”‚ Alertmanagerâ”‚           â”‚
â”‚  â”‚ (å•å®ä¾‹)    â”‚ â”‚ (å•å®ä¾‹)    â”‚ â”‚ (å•å®ä¾‹)    â”‚           â”‚
â”‚  â”‚   :8080     â”‚ â”‚  :50061     â”‚ â”‚   :9093     â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  æ•°æ®å­˜å‚¨å±‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ PostgreSQL  â”‚ â”‚ Redis       â”‚ â”‚ InfluxDB    â”‚           â”‚
â”‚  â”‚ (å•å®ä¾‹)    â”‚ â”‚ (å•å®ä¾‹)    â”‚ â”‚ (å•å®ä¾‹)    â”‚           â”‚
â”‚  â”‚   :5432     â”‚ â”‚   :6379     â”‚ â”‚   :8086     â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  æ¶ˆæ¯å’Œç›‘æ§å±‚                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ NATS        â”‚ â”‚ Prometheus  â”‚ â”‚ Grafana     â”‚           â”‚
â”‚  â”‚ (å•å®ä¾‹)    â”‚ â”‚ (å•å®ä¾‹)    â”‚ â”‚ (å•å®ä¾‹)    â”‚           â”‚
â”‚  â”‚ :4222/8222  â”‚ â”‚   :9090     â”‚ â”‚   :3000     â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### éƒ¨ç½²é…ç½®

- **APIæœåŠ¡**: å•å®ä¾‹éƒ¨ç½²ï¼Œç«¯å£8080
- **æ•°æ®åº“**: PostgreSQLå•å®ä¾‹ï¼Œç«¯å£5432
- **ç¼“å­˜**: Rediså•å®ä¾‹ï¼Œç«¯å£6379
- **æ¶ˆæ¯é˜Ÿåˆ—**: NATSå•å®ä¾‹ï¼Œç«¯å£4222/8222
- **ç›‘æ§**: Prometheus + Grafana + Alertmanager
- **åå‘ä»£ç†**: Nginxï¼Œç«¯å£80/443
- **ç¡¬ä»¶ç®¡ç†**: Tinkerbellï¼Œç«¯å£50061
- **æ—¶åºæ•°æ®åº“**: InfluxDBï¼Œç«¯å£8086

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **Tinkerbellè¿æ¥å¤±è´¥**
   - æ£€æŸ¥ç½‘ç»œè¿é€šæ€§
   - éªŒè¯è®¤è¯ä¿¡æ¯
   - æŸ¥çœ‹Tinkerbellæ—¥å¿—

2. **GPUå‘ç°å¤±è´¥**
   - æ£€æŸ¥ç¡¬ä»¶ç®¡ç†åè®®é…ç½®
   - éªŒè¯ç½‘ç»œè¿æ¥
   - æŸ¥çœ‹ç¡¬ä»¶æ—¥å¿—

3. **äº‹ä»¶å¤„ç†å¼‚å¸¸**
   - æ£€æŸ¥NATSè¿æ¥çŠ¶æ€
   - éªŒè¯äº‹ä»¶æ ¼å¼
   - æŸ¥çœ‹äº‹ä»¶å¤„ç†æ—¥å¿—

### æ—¥å¿—æŸ¥çœ‹

```bash
# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
docker logs gpu-management-api

# æŸ¥çœ‹Tinkerbellæ—¥å¿—
docker logs gpu-management-tinkerbell

# æŸ¥çœ‹æ•°æ®åº“æ—¥å¿—
docker logs gpu-management-postgres
```

## æœ€è¿‘æ›´æ–°

### v2.0.0 (2025-08-17)
- âœ… **Echoæ¡†æ¶é€‰å®š**: ä½¿ç”¨Echo v4.11.4ä½œä¸ºWebæ¡†æ¶
- âœ… **äº‹ä»¶æ€»çº¿ä¼˜åŒ–**: EventBusæ”¯æŒContextå‚æ•°
- âœ… **ä¸­é—´ä»¶å¢å¼º**: æ–°å¢Contextä¸­é—´ä»¶ï¼Œæ”¯æŒè¯·æ±‚è¿½è¸ª
- âœ… **é”™è¯¯å¤„ç†å®Œå–„**: åŒºåˆ†Contexté”™è¯¯å’Œä¸šåŠ¡é”™è¯¯
- âœ… **è¶…æ—¶æ§åˆ¶**: å¤šå±‚æ¬¡è¶…æ—¶æ§åˆ¶æœºåˆ¶
- âœ… **ä»£ç è´¨é‡æå‡**: ç¬¦åˆGoè¯­è¨€Contextæœ€ä½³å®è·µ

### æŠ€æœ¯æ”¹è¿›
- **æ€§èƒ½ä¼˜åŒ–**: Echoæ¡†æ¶é›¶å†…å­˜åˆ†é…è·¯ç”±
- **å¯ç»´æŠ¤æ€§**: ç»Ÿä¸€çš„Contextä½¿ç”¨æ¨¡å¼
- **å¯æ‰©å±•æ€§**: çµæ´»çš„ä¸­é—´ä»¶æ¶æ„
- **å¯é æ€§**: å®Œæ•´çš„é”™è¯¯å¤„ç†å’Œèµ„æºç®¡ç†

## è´¡çŒ®æŒ‡å—

1. Forké¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. æäº¤ä»£ç å˜æ›´ï¼ˆéµå¾ªGoè¯­è¨€æœ€ä½³å®è·µï¼‰
4. åˆ›å»ºPull Request

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨Apache 2.0è®¸å¯è¯ï¼Œè¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

## è”ç³»æ–¹å¼

- é¡¹ç›®ä¸»é¡µ: https://github.com/linview/gpu-resource-manager-backend
- é—®é¢˜åé¦ˆ: https://github.com/linview/gpu-resource-manager-backend/issues
- æ–‡æ¡£: https://github.com/linview/gpu-resource-manager-backend/docs
- æ¶æ„è®¾è®¡: [docs/design/architecture-design.md](docs/design/architecture-design.md)
- Contexté‡æ„: [docs/review/context-refactoring-summary.md](docs/review/context-refactoring-summary.md)
